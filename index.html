<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Mis Finanzas">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%237c3aed' width='100' height='100'/><text y='75' font-size='70' fill='white' text-anchor='middle' x='50'>$</text></svg>">
    <title>Mi Gestor Financiero - NU</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        /* Optimizaciones para m√≥vil */
        * {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }

        /* Prevenir zoom en inputs */
        input, select, textarea {
            font-size: 16px !important;
        }

        /* Mejorar scrolling en iOS */
        .scroll-smooth {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function FinanzasApp() {
            const [transacciones, setTransacciones] = useState([]);
            const [presupuestoSemanal, setPresupuestoSemanal] = useState(2000);
            const [metasAhorro, setMetasAhorro] = useState([
                { id: 1, nombre: 'Vacaciones', monto: 10000, actual: 0, icono: '‚úàÔ∏è', color: 'blue' }
            ]);
            const [vistaActual, setVistaActual] = useState('dashboard');
            const [mostrarFormulario, setMostrarFormulario] = useState(false);
            const [mostrarFormularioMeta, setMostrarFormularioMeta] = useState(false);
            const [notificaciones, setNotificaciones] = useState([]);
            const [importando, setImportando] = useState(false);
            const fileInputRef = useRef(null);
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            const [nuevaTransaccion, setNuevaTransaccion] = useState({
                tipo: 'gasto',
                monto: '',
                categoria: 'comida',
                descripcion: '',
                fecha: new Date().toISOString().split('T')[0],
                metaId: ''
            });

            const [nuevaMeta, setNuevaMeta] = useState({
                nombre: '',
                monto: '',
                icono: 'üéØ',
                color: 'blue'
            });

            useEffect(() => {
                const datosGuardados = localStorage.getItem('finanzasData');
                if (datosGuardados) {
                    const datos = JSON.parse(datosGuardados);
                    setTransacciones(datos.transacciones || []);
                    setPresupuestoSemanal(datos.presupuestoSemanal || 2000);
                    setMetasAhorro(datos.metasAhorro || [{ id: 1, nombre: 'Vacaciones', monto: 10000, actual: 0, icono: '‚úàÔ∏è', color: 'blue' }]);
                }
            }, []);

            useEffect(() => {
                const datos = { transacciones, presupuestoSemanal, metasAhorro };
                localStorage.setItem('finanzasData', JSON.stringify(datos));
            }, [transacciones, presupuestoSemanal, metasAhorro]);

            useEffect(() => {
                const gastoSemanal = calcularGastoSemanal();
                const porcentaje = (gastoSemanal / presupuestoSemanal) * 100;
                if (porcentaje >= 90 && porcentaje < 100) {
                    agregarNotificacion('‚ö†Ô∏è ¬°Alerta! Has gastado el ' + porcentaje.toFixed(0) + '% de tu presupuesto semanal', 'warning');
                } else if (porcentaje >= 100) {
                    agregarNotificacion('üö® ¬°Has rebasado tu presupuesto semanal!', 'error');
                }
            }, [transacciones]);

            const agregarNotificacion = (mensaje, tipo) => {
                const nuevaNotif = { id: Date.now(), mensaje, tipo };
                setNotificaciones(prev => [...prev, nuevaNotif]);
                setTimeout(() => {
                    setNotificaciones(prev => prev.filter(n => n.id !== nuevaNotif.id));
                }, 5000);
            };

            const calcularGastoSemanal = () => {
                const hoy = new Date();
                const inicioSemana = new Date(hoy);
                inicioSemana.setDate(hoy.getDate() - hoy.getDay());
                inicioSemana.setHours(0, 0, 0, 0);
                return transacciones.filter(t => t.tipo === 'gasto' && new Date(t.fecha) >= inicioSemana).reduce((sum, t) => sum + parseFloat(t.monto), 0);
            };

            const calcularGastoMensual = () => {
                const hoy = new Date();
                const inicioMes = new Date(hoy.getFullYear(), hoy.getMonth(), 1);
                return transacciones.filter(t => t.tipo === 'gasto' && new Date(t.fecha) >= inicioMes).reduce((sum, t) => sum + parseFloat(t.monto), 0);
            };

            const calcularIngresoMensual = () => {
                const hoy = new Date();
                const inicioMes = new Date(hoy.getFullYear(), hoy.getMonth(), 1);
                return transacciones.filter(t => t.tipo === 'ingreso' && new Date(t.fecha) >= inicioMes).reduce((sum, t) => sum + parseFloat(t.monto), 0);
            };

            const agregarTransaccion = (e) => {
                e.preventDefault();
                if (!nuevaTransaccion.monto || parseFloat(nuevaTransaccion.monto) <= 0) {
                    agregarNotificacion('‚ùå Por favor ingresa un monto v√°lido', 'error');
                    return;
                }
                const transaccion = { id: Date.now(), ...nuevaTransaccion, monto: parseFloat(nuevaTransaccion.monto) };
                setTransacciones([transaccion, ...transacciones]);
                
                if (nuevaTransaccion.tipo === 'ahorro' && nuevaTransaccion.metaId) {
                    setMetasAhorro(metasAhorro.map(meta => 
                        meta.id === parseInt(nuevaTransaccion.metaId)
                            ? { ...meta, actual: meta.actual + transaccion.monto }
                            : meta
                    ));
                    agregarNotificacion('‚úÖ ¬°Ahorro registrado!', 'success');
                }
                
                setNuevaTransaccion({ tipo: 'gasto', monto: '', categoria: 'comida', descripcion: '', fecha: new Date().toISOString().split('T')[0], metaId: '' });
                setMostrarFormulario(false);
            };

            const eliminarTransaccion = (id) => {
                const transaccion = transacciones.find(t => t.id === id);
                if (transaccion.tipo === 'ahorro' && transaccion.metaId) {
                    setMetasAhorro(metasAhorro.map(meta =>
                        meta.id === parseInt(transaccion.metaId)
                            ? { ...meta, actual: Math.max(0, meta.actual - transaccion.monto) }
                            : meta
                    ));
                }
                setTransacciones(transacciones.filter(t => t.id !== id));
                agregarNotificacion('üóëÔ∏è Transacci√≥n eliminada', 'info');
            };

            const gastosPorCategoria = () => {
                const categorias = {};
                transacciones.filter(t => t.tipo === 'gasto').forEach(t => {
                    categorias[t.categoria] = (categorias[t.categoria] || 0) + t.monto;
                });
                return categorias;
            };

            const agregarMeta = (e) => {
                e.preventDefault();
                if (!nuevaMeta.nombre || !nuevaMeta.monto || parseFloat(nuevaMeta.monto) <= 0) {
                    agregarNotificacion('‚ùå Completa todos los campos', 'error');
                    return;
                }
                const meta = {
                    id: Date.now(),
                    nombre: nuevaMeta.nombre,
                    monto: parseFloat(nuevaMeta.monto),
                    actual: 0,
                    icono: nuevaMeta.icono,
                    color: nuevaMeta.color
                };
                setMetasAhorro([...metasAhorro, meta]);
                setNuevaMeta({ nombre: '', monto: '', icono: 'üéØ', color: 'blue' });
                setMostrarFormularioMeta(false);
                agregarNotificacion('‚úÖ Meta creada', 'success');
            };

            const eliminarMeta = (id) => {
                if (confirm('¬øEliminar esta meta?')) {
                    setMetasAhorro(metasAhorro.filter(m => m.id !== id));
                    agregarNotificacion('üóëÔ∏è Meta eliminada', 'info');
                }
            };

            const importarCSV = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                setImportando(true);
                Papa.parse(file, {
                    header: true,
                    skipEmptyLines: true,
                    complete: (results) => {
                        try {
                            const transaccionesImportadas = [];
                            let exitosas = 0;
                            results.data.forEach((fila, index) => {
                                try {
                                    let fecha = fila.date || fila.fecha || '';
                                    let descripcion = fila.description || fila.descripcion || '';
                                    let monto = fila.amount || fila.monto || '';
                                    let categoria = fila.category || fila.categoria || '';
                                    if (typeof monto === 'string') {
                                        monto = monto.replace(/[R$\s,MXN]/g, '').replace(',', '.');
                                    }
                                    monto = parseFloat(monto);
                                    if (!fecha || isNaN(monto) || monto === 0) return;
                                    const tipo = monto < 0 ? 'gasto' : 'ingreso';
                                    monto = Math.abs(monto);
                                    const transaccion = {
                                        id: Date.now() + index,
                                        tipo,
                                        monto,
                                        categoria: categoria || 'otros',
                                        descripcion: descripcion || 'Importada',
                                        fecha: fecha
                                    };
                                    transaccionesImportadas.push(transaccion);
                                    exitosas++;
                                } catch (error) {}
                            });
                            if (transaccionesImportadas.length > 0) {
                                setTransacciones([...transaccionesImportadas, ...transacciones]);
                                agregarNotificacion(`‚úÖ Importadas ${exitosas} transacciones`, 'success');
                            }
                        } catch (error) {
                            agregarNotificacion('‚ùå Error al procesar CSV', 'error');
                        } finally {
                            setImportando(false);
                            if (fileInputRef.current) fileInputRef.current.value = '';
                        }
                    }
                });
            };

            const Dashboard = () => {
                const gastoSemanal = calcularGastoSemanal();
                const gastoMensual = calcularGastoMensual();
                const ingresoMensual = calcularIngresoMensual();
                const porcentajeSemanal = (gastoSemanal / presupuestoSemanal) * 100;
                const balance = ingresoMensual - gastoMensual;

                useEffect(() => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }

                    if (chartRef.current && Object.keys(gastosPorCategoria()).length > 0) {
                        const ctx = chartRef.current.getContext('2d');
                        const categorias = gastosPorCategoria();
                        const colores = {
                            comida: 'rgb(251, 146, 60)',
                            transporte: 'rgb(59, 130, 246)',
                            entretenimiento: 'rgb(168, 85, 247)',
                            servicios: 'rgb(234, 179, 8)',
                            salud: 'rgb(239, 68, 68)',
                            otros: 'rgb(107, 114, 128)'
                        };

                        chartInstance.current = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: Object.keys(categorias).map(c => c.charAt(0).toUpperCase() + c.slice(1)),
                                datasets: [{
                                    data: Object.values(categorias),
                                    backgroundColor: Object.keys(categorias).map(c => colores[c]),
                                    borderWidth: 2,
                                    borderColor: '#fff'
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: 11 } } },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                const value = context.parsed || 0;
                                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                                const porcentaje = ((value / total) * 100).toFixed(1);
                                                return `$${value.toFixed(2)} (${porcentaje}%)`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                    }

                    return () => {
                        if (chartInstance.current) {
                            chartInstance.current.destroy();
                        }
                    };
                }, [transacciones]);

                return (
                    <div className="space-y-4 p-4">
                        <div className="grid grid-cols-1 gap-4">
                            <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-5 text-white shadow-lg">
                                <div className="text-sm opacity-90">Balance del mes</div>
                                <div className="text-3xl font-bold mt-2">${balance.toFixed(2)}</div>
                                <div className="text-xs mt-2 opacity-75">Ingresos: ${ingresoMensual.toFixed(2)} | Gastos: ${gastoMensual.toFixed(2)}</div>
                            </div>

                            <div className={`rounded-xl p-5 text-white shadow-lg ${
                                porcentajeSemanal >= 100 ? 'bg-gradient-to-br from-red-500 to-red-600' :
                                porcentajeSemanal >= 80 ? 'bg-gradient-to-br from-orange-500 to-orange-600' :
                                'bg-gradient-to-br from-green-500 to-green-600'
                            }`}>
                                <div className="text-sm opacity-90">Gasto semanal</div>
                                <div className="text-3xl font-bold mt-2">${gastoSemanal.toFixed(2)}</div>
                                <div className="mt-3 bg-white bg-opacity-20 rounded-full h-3">
                                    <div className="bg-white h-3 rounded-full transition-all" style={{ width: `${Math.min(porcentajeSemanal, 100)}%` }}></div>
                                </div>
                                <div className="text-xs mt-2">{porcentajeSemanal.toFixed(0)}% de ${presupuestoSemanal}</div>
                            </div>
                        </div>

                        {/* Gr√°fica de Gastos */}
                        {Object.keys(gastosPorCategoria()).length > 0 && (
                            <div className="bg-white rounded-xl p-5 shadow-md">
                                <h3 className="text-lg font-bold mb-3 text-gray-800">üìä Distribuci√≥n de Gastos</h3>
                                <div style={{ height: '200px', position: 'relative' }}>
                                    <canvas ref={chartRef}></canvas>
                                </div>
                            </div>
                        )}

                        {/* Metas de Ahorro */}
                        <div className="bg-white rounded-xl p-5 shadow-md">
                            <div className="flex justify-between items-center mb-3">
                                <h3 className="text-lg font-bold text-gray-800">üéØ Mis Metas</h3>
                                <button onClick={() => setMostrarFormularioMeta(true)} className="bg-blue-600 text-white px-3 py-1 rounded-lg text-sm font-medium">
                                    + Meta
                                </button>
                            </div>
                            <div className="space-y-3">
                                {metasAhorro.map(meta => {
                                    const porcentaje = (meta.actual / meta.monto) * 100;
                                    const colores = {
                                        blue: 'from-blue-500 to-blue-600',
                                        green: 'from-green-500 to-green-600',
                                        purple: 'from-purple-500 to-purple-600',
                                        pink: 'from-pink-500 to-pink-600',
                                        yellow: 'from-yellow-500 to-yellow-600',
                                        red: 'from-red-500 to-red-600'
                                    };
                                    return (
                                        <div key={meta.id} className={`bg-gradient-to-br ${colores[meta.color]} rounded-xl p-4 text-white shadow relative`}>
                                            <button onClick={() => eliminarMeta(meta.id)} className="absolute top-2 right-2 text-white text-sm">‚úï</button>
                                            <div className="flex items-center space-x-2 mb-2">
                                                <span className="text-2xl">{meta.icono}</span>
                                                <span className="font-bold">{meta.nombre}</span>
                                            </div>
                                            <div className="text-2xl font-bold">${meta.actual.toFixed(2)}</div>
                                            <div className="mt-2 bg-white bg-opacity-20 rounded-full h-2">
                                                <div className="bg-white h-2 rounded-full transition-all" style={{ width: `${Math.min(porcentaje, 100)}%` }}></div>
                                            </div>
                                            <div className="text-xs mt-1 flex justify-between">
                                                <span>{porcentaje.toFixed(0)}%</span>
                                                <span>Meta: ${meta.monto.toFixed(2)}</span>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Transacciones Recientes */}
                        <div className="bg-white rounded-xl p-5 shadow-md">
                            <h3 className="text-lg font-bold mb-3">Transacciones Recientes</h3>
                            {transacciones.slice(0, 5).map(t => (
                                <div key={t.id} className="flex items-center justify-between py-3 border-b">
                                    <div className="flex items-center space-x-3">
                                        <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                                            t.tipo === 'ingreso' ? 'bg-green-100 text-green-600' : t.tipo === 'ahorro' ? 'bg-blue-100 text-blue-600' : 'bg-red-100 text-red-600'
                                        }`}>
                                            {t.tipo === 'ingreso' ? '‚Üì' : t.tipo === 'ahorro' ? 'üí∞' : '‚Üë'}
                                        </div>
                                        <div>
                                            <div className="font-medium text-sm">{t.descripcion || t.categoria}</div>
                                            <div className="text-xs text-gray-500">{new Date(t.fecha).toLocaleDateString('es-MX')}</div>
                                        </div>
                                    </div>
                                    <div className={`font-bold ${t.tipo === 'ingreso' ? 'text-green-600' : t.tipo === 'ahorro' ? 'text-blue-600' : 'text-red-600'}`}>
                                        {t.tipo === 'ingreso' ? '+' : '-'}${t.monto.toFixed(2)}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            const Transacciones = () => {
                return (
                    <div className="p-4">
                        <div className="bg-white rounded-xl p-5 shadow-md">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-xl font-bold">Transacciones</h3>
                                <button onClick={() => setMostrarFormulario(true)} className="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                    + Nueva
                                </button>
                            </div>
                            {transacciones.length === 0 ? (
                                <div className="text-center py-12 text-gray-500">
                                    <div className="text-6xl mb-4">üìä</div>
                                    <p>No hay transacciones</p>
                                </div>
                            ) : (
                                <div className="space-y-2">
                                    {transacciones.map(t => (
                                        <div key={t.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                            <div className="flex items-center space-x-3 flex-1">
                                                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                                                    t.tipo === 'ingreso' ? 'bg-green-100 text-green-600' : t.tipo === 'ahorro' ? 'bg-blue-100 text-blue-600' : 'bg-red-100 text-red-600'
                                                }`}>
                                                    {t.tipo === 'ingreso' ? '‚Üì' : t.tipo === 'ahorro' ? 'üí∞' : '‚Üë'}
                                                </div>
                                                <div className="flex-1">
                                                    <div className="font-medium text-sm">{t.descripcion || t.categoria}</div>
                                                    <div className="text-xs text-gray-500">{new Date(t.fecha).toLocaleDateString('es-MX')}</div>
                                                </div>
                                            </div>
                                            <div className="flex items-center space-x-2">
                                                <div className={`font-bold text-sm ${t.tipo === 'ingreso' ? 'text-green-600' : t.tipo === 'ahorro' ? 'text-blue-600' : 'text-red-600'}`}>
                                                    {t.tipo === 'ingreso' ? '+' : '-'}${t.monto.toFixed(2)}
                                                </div>
                                                <button onClick={() => eliminarTransaccion(t.id)} className="text-red-500 text-sm">üóëÔ∏è</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const Configuracion = () => {
                const [tempPresupuesto, setTempPresupuesto] = useState(presupuestoSemanal);

                return (
                    <div className="p-4 space-y-4">
                        <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-5 text-white shadow-lg">
                            <h3 className="text-xl font-bold mb-3">üì• Importar CSV</h3>
                            <input ref={fileInputRef} type="file" accept=".csv" onChange={importarCSV} disabled={importando} className="hidden" id="csv-upload" />
                            <label htmlFor="csv-upload" className={`block text-center bg-white text-purple-600 px-4 py-3 rounded-lg font-bold ${importando ? 'opacity-50' : 'cursor-pointer'}`}>
                                {importando ? '‚è≥ Importando...' : 'üìÇ Seleccionar CSV'}
                            </label>
                        </div>

                        <div className="bg-white rounded-xl p-5 shadow-md">
                            <h3 className="text-xl font-bold mb-3">‚öôÔ∏è Configuraci√≥n</h3>
                            <div>
                                <label className="block text-sm font-medium mb-2">Presupuesto Semanal</label>
                                <div className="flex space-x-2">
                                    <input type="number" value={tempPresupuesto} onChange={(e) => setTempPresupuesto(parseFloat(e.target.value))} 
                                           className="flex-1 border rounded-lg px-4 py-2" />
                                    <button onClick={() => { setPresupuestoSemanal(tempPresupuesto); agregarNotificacion('‚úÖ Guardado', 'success'); }} 
                                            className="bg-purple-600 text-white px-4 py-2 rounded-lg">Guardar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50">
                    {/* Notificaciones */}
                    <div className="fixed top-4 right-4 z-50 space-y-2">
                        {notificaciones.map(notif => (
                            <div key={notif.id} className={`px-4 py-3 rounded-lg shadow-lg text-white text-sm font-medium ${
                                notif.tipo === 'error' ? 'bg-red-500' : notif.tipo === 'warning' ? 'bg-orange-500' : notif.tipo === 'success' ? 'bg-green-500' : 'bg-blue-500'
                            }`}>
                                {notif.mensaje}
                            </div>
                        ))}
                    </div>

                    {/* Modal Formulario */}
                    {mostrarFormulario && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 p-4">
                            <div className="bg-white rounded-xl p-5 max-w-md w-full shadow-2xl">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">Nueva Transacci√≥n</h3>
                                    <button onClick={() => setMostrarFormulario(false)} className="text-gray-500 text-2xl">√ó</button>
                                </div>
                                <form onSubmit={agregarTransaccion} className="space-y-3">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Tipo</label>
                                        <select value={nuevaTransaccion.tipo} onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, tipo: e.target.value})} 
                                                className="w-full border rounded-lg px-4 py-2">
                                            <option value="gasto">üí∏ Gasto</option>
                                            <option value="ingreso">üíµ Ingreso</option>
                                            <option value="ahorro">üí∞ Ahorro</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Monto</label>
                                        <input type="number" step="0.01" value={nuevaTransaccion.monto} 
                                               onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, monto: e.target.value})} 
                                               className="w-full border rounded-lg px-4 py-2" placeholder="0.00" required />
                                    </div>
                                    {nuevaTransaccion.tipo !== 'ahorro' && (
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Categor√≠a</label>
                                            <select value={nuevaTransaccion.categoria} 
                                                    onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, categoria: e.target.value})} 
                                                    className="w-full border rounded-lg px-4 py-2">
                                                <option value="comida">üçî Comida</option>
                                                <option value="transporte">üöó Transporte</option>
                                                <option value="entretenimiento">üéÆ Entretenimiento</option>
                                                <option value="servicios">üí° Servicios</option>
                                                <option value="salud">‚öïÔ∏è Salud</option>
                                                <option value="otros">üì¶ Otros</option>
                                            </select>
                                        </div>
                                    )}
                                    {nuevaTransaccion.tipo === 'ahorro' && metasAhorro.length > 0 && (
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Meta de Ahorro</label>
                                            <select value={nuevaTransaccion.metaId} 
                                                    onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, metaId: e.target.value})} 
                                                    className="w-full border rounded-lg px-4 py-2">
                                                <option value="">Selecciona una meta</option>
                                                {metasAhorro.map(meta => (
                                                    <option key={meta.id} value={meta.id}>{meta.icono} {meta.nombre}</option>
                                                ))}
                                            </select>
                                        </div>
                                    )}
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Descripci√≥n</label>
                                        <input type="text" value={nuevaTransaccion.descripcion} 
                                               onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, descripcion: e.target.value})} 
                                               className="w-full border rounded-lg px-4 py-2" placeholder="Ej: Uber al trabajo" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Fecha</label>
                                        <input type="date" value={nuevaTransaccion.fecha} 
                                               onChange={(e) => setNuevaTransaccion({...nuevaTransaccion, fecha: e.target.value})} 
                                               className="w-full border rounded-lg px-4 py-2" required />
                                    </div>
                                    <div className="flex space-x-3 pt-2">
                                        <button type="button" onClick={() => setMostrarFormulario(false)} 
                                                className="flex-1 bg-gray-200 py-2 rounded-lg font-medium">Cancelar</button>
                                        <button type="submit" className="flex-1 bg-purple-600 text-white py-2 rounded-lg font-medium">Agregar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Modal Nueva Meta */}
                    {mostrarFormularioMeta && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 p-4">
                            <div className="bg-white rounded-xl p-5 max-w-md w-full shadow-2xl">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">Nueva Meta de Ahorro</h3>
                                    <button onClick={() => setMostrarFormularioMeta(false)} className="text-gray-500 text-2xl">√ó</button>
                                </div>
                                <form onSubmit={agregarMeta} className="space-y-3">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Nombre de la Meta</label>
                                        <input type="text" value={nuevaMeta.nombre} 
                                               onChange={(e) => setNuevaMeta({...nuevaMeta, nombre: e.target.value})} 
                                               className="w-full border rounded-lg px-4 py-2" placeholder="Ej: Vacaciones, Auto nuevo" required />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Monto Objetivo</label>
                                        <input type="number" step="0.01" value={nuevaMeta.monto} 
                                               onChange={(e) => setNuevaMeta({...nuevaMeta, monto: e.target.value})} 
                                               className="w-full border rounded-lg px-4 py-2" placeholder="0.00" required />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Icono</label>
                                        <div className="grid grid-cols-6 gap-2">
                                            {['‚úàÔ∏è', 'üè†', 'üöó', 'üí∞', 'üéì', 'üíç', 'üéÆ', 'üì±', 'üèñÔ∏è', 'üéØ', 'üéÅ', 'üíª'].map(icono => (
                                                <button key={icono} type="button"
                                                        onClick={() => setNuevaMeta({...nuevaMeta, icono})}
                                                        className={`text-2xl p-2 rounded-lg border-2 ${nuevaMeta.icono === icono ? 'border-purple-600 bg-purple-50' : 'border-gray-200'}`}>
                                                    {icono}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Color</label>
                                        <div className="grid grid-cols-6 gap-2">
                                            {[
                                                {name: 'blue', color: 'bg-blue-500'},
                                                {name: 'green', color: 'bg-green-500'},
                                                {name: 'purple', color: 'bg-purple-500'},
                                                {name: 'pink', color: 'bg-pink-500'},
                                                {name: 'yellow', color: 'bg-yellow-500'},
                                                {name: 'red', color: 'bg-red-500'}
                                            ].map(({name, color}) => (
                                                <button key={name} type="button"
                                                        onClick={() => setNuevaMeta({...nuevaMeta, color: name})}
                                                        className={`w-10 h-10 rounded-lg ${color} border-2 ${nuevaMeta.color === name ? 'border-gray-800' : 'border-gray-200'}`}>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="flex space-x-3 pt-2">
                                        <button type="button" onClick={() => setMostrarFormularioMeta(false)} 
                                                className="flex-1 bg-gray-200 py-2 rounded-lg font-medium">Cancelar</button>
                                        <button type="submit" className="flex-1 bg-blue-600 text-white py-2 rounded-lg font-medium">Crear Meta</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <div className="bg-white shadow-sm sticky top-0 z-30">
                        <div className="px-4 py-3">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-2">
                                    <div className="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center text-white font-bold">$</div>
                                    <h1 className="text-lg font-bold">Mis Finanzas</h1>
                                </div>
                                <button onClick={() => setMostrarFormulario(true)} className="bg-purple-600 text-white px-3 py-2 rounded-lg text-sm font-medium">+</button>
                            </div>
                        </div>
                    </div>

                    {/* Navegaci√≥n */}
                    <div className="px-4 py-3">
                        <div className="bg-white rounded-xl shadow-sm p-1 flex space-x-1">
                            {[
                                { id: 'dashboard', nombre: 'Inicio', icono: 'üìä' },
                                { id: 'transacciones', nombre: 'Transacciones', icono: 'üí≥' },
                                { id: 'config', nombre: 'Config', icono: '‚öôÔ∏è' }
                            ].map(vista => (
                                <button key={vista.id} onClick={() => setVistaActual(vista.id)} 
                                        className={`flex-1 py-2 px-2 rounded-lg text-sm font-medium transition ${
                                            vistaActual === vista.id ? 'bg-purple-600 text-white' : 'text-gray-600'
                                        }`}>
                                    <span className="mr-1">{vista.icono}</span>{vista.nombre}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Contenido */}
                    <div className="pb-8">
                        {vistaActual === 'dashboard' && <Dashboard />}
                        {vistaActual === 'transacciones' && <Transacciones />}
                        {vistaActual === 'config' && <Configuracion />}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<FinanzasApp />, document.getElementById('root'));
    </script>
</body>
</html>